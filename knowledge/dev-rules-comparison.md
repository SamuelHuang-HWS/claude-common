# AI 开发规范体系对比分析

> **文档目的**: 团队规范讨论，对比两套规则体系的设计理念与优劣
> **更新时间**: 2026-01-25
> **注意**: 本文聚焦**规则设计**本身，与具体工具无关

---

## 一、两套规范体系概述

| 维度 | 规范 A（严谨型） | 规范 B（效率型） |
|------|------------------|------------------|
| **核心理念** | AI 需要约束，先规划再执行 | AI 是助手，信任并快速执行 |
| **流程控制** | 三步走死令 + 零信任 | 协作分层（L1/L2/L3） |
| **防失控** | 物理拦截 + 熔断认错 | 中场偏移报告 |
| **任务分级** | P0/P1/P2/P3 强制分流 | 按复杂度建议分级 |
| **文档要求** | spec + plan + task 强制 | 按需创建 |

---

## 二、核心机制对比

### 2.1 流程控制

#### 规范 A：三步走死令 + 零信任

```
用户提需求
    ↓
[物理拦截] AI 禁止直接执行
    ↓
引导用户发送 /start-xxx 命令
    ↓
Step 1: 规划 → 创建 spec/plan/task
    ↓
Step 2: 确认 → 用户显式批准 Plan
    ↓
Step 3: 实现 → 方可操作业务文件
```

**特点**：
- 未发送 `/xxx` 命令前，AI 处于"观察者"模式
- 禁止调用任何写入工具
- 禁止输出具体业务代码
- 只允许提供任务分级建议和命令列表

#### 规范 B：协作分层

```
用户提需求
    ↓
[心智审计] AI 内部确认是否理解
    ↓
根据复杂度选择行动级别：
├── L1（直接执行）：读、搜、测试、单行修复
├── L2（告知后执行）：常规功能开发
└── L3（必须确认）：架构变更、删除文件
```

**特点**：
- 简单任务可直接执行，无需走流程
- 复杂任务告知方案后执行
- 只有高风险操作才需要显式确认

#### 对比

| 维度 | 规范 A | 规范 B |
|------|--------|--------|
| 控制强度 | 强（物理拦截） | 弱（建议性） |
| 执行效率 | 低（必须走流程） | 高（可直接执行） |
| 安全性 | 高（防止 AI 乱动） | 中（依赖 AI 判断） |
| 用户体验 | 繁琐但可控 | 流畅但需信任 |

---

### 2.2 防失控机制

#### 规范 A：熔断认错

```
AI 发现自己违规时（如未确认就写代码）：
├── 必须主动认错
├── 征求用户意见
├── 执行 /finish-task 清理无效文档
└── 重新开始
```

**违规熔断场景**：
- 未初始化阶段输出代码
- 静默修复问题（未登记）
- 任务进度漏登

#### 规范 B：中场偏移报告

```
实施中触发非预期问题时：
├── 立即报告，不静默修复
├── 在 Task 中登记子项
└── 申请方案后再修复
```

#### 对比

| 维度 | 规范 A | 规范 B |
|------|--------|--------|
| 触发条件 | AI 自我检测违规 | 发现问题时报告 |
| 处理方式 | 强制认错 + 清理 | 登记 + 继续 |
| 严厉程度 | 高（可能重来） | 中（补救继续） |

---

### 2.3 任务分级

#### 规范 A：P0-P3 强制分流

| 级别 | 场景 | 强制要求 |
|------|------|----------|
| **P0** | 重大需求/架构变更 | Spec + Plan + Task + ADR |
| **P1** | 小型任务 | Plan + Task |
| **P2** | 故障修复 | 复现用例 + 预期 + 实际 |
| **P3** | 技术调研 | 调研笔记 + POC |

**特点**：不同级别有不同的文档要求，强制执行

#### 规范 B：建议性分级

| 级别 | 场景 | 建议行动 |
|------|------|----------|
| **P0** | 重大需求 | 创建文档，需确认 |
| **P1** | 常规功能 | 创建文档，需确认 |
| **P2** | Bug 修复 | 创建 Plan，需确认 |
| **Trivial** | ≤3 行修改 | 说明后直接执行 |

**特点**：有豁免条款，小任务可跳过流程

#### 对比

| 维度 | 规范 A | 规范 B |
|------|--------|--------|
| 灵活性 | 低（必须分级） | 高（有豁免） |
| 文档完整性 | 高（强制产出） | 中（按需产出） |
| 小任务效率 | 低（也要走流程） | 高（可跳过） |

---

### 2.4 文档归档

#### 规范 A：目录结构（原始）

```
docs/_scaffold/task-name/
├── spec.md      # 需求规格
├── plan.md      # 技术方案
└── task.md      # 施工清单

完成后移动到：
docs/archive/YYYY/MM/task-name/
```

#### 规范 B / 统一优化后：单文件结构

```
docs/archive/YYYY/MM/task-name.md

---
title: 功能名称
status: completed
---

## 📋 Spec
## 🏗️ Plan
## ✅ Tasks
## 💡 Learnings    ← 新增：强制知识提炼
```

#### 对比

| 维度 | 目录结构 | 单文件结构 |
|------|----------|------------|
| 文件数量 | 3 文件/任务 | 1 文件/任务 |
| 上下文 | 分散，需读多个文件 | 集中，一次读取 |
| Learnings | 无 | 强制填写 |
| 知识沉淀 | 弱 | 强 |

---

### 2.5 CHANGELOG 管理

#### 规范 A：图书馆模式

```
CHANGELOG.md
├── 仅做简要索引
└── 详情链接到 archive/
```

#### 统一优化后：分层索引

```
CHANGELOG.md           # 主索引（按年/月链接）
    ↓
changelogs/2026-01.md  # 月度详情
    ↓
archive/2026/01/xxx.md # 完整文档
```

---

## 三、优劣总结

### 规范 A（严谨型）优势

| 优势 | 说明 |
|------|------|
| ✅ 防止 AI 失控 | 物理拦截 + 零信任，AI 不会乱动 |
| ✅ 文档完整 | 强制 spec/plan/task，可追溯 |
| ✅ 自我纠错 | 熔断机制，AI 主动认错 |
| ✅ 流程规范 | 三步走，确保先想后做 |
| ✅ 团队协作友好 | 新人可以追溯历史决策 |

### 规范 A（严谨型）劣势

| 劣势 | 说明 |
|------|------|
| ❌ 效率低 | 小任务也要走完整流程 |
| ❌ 繁琐 | 每次都要发 /start-xxx 命令 |
| ❌ 规则冗长 | 全局规则约 150 行 |
| ❌ 学习成本高 | 新人需要理解整套流程 |

### 规范 B（效率型）优势

| 优势 | 说明 |
|------|------|
| ✅ 效率高 | 小任务直接执行 |
| ✅ 灵活 | 有豁免条款 |
| ✅ 规则精简 | 全局规则约 70 行 |
| ✅ 上手快 | 简单易懂 |

### 规范 B（效率型）劣势

| 劣势 | 说明 |
|------|------|
| ❌ 依赖 AI 判断 | AI 可能误判复杂度 |
| ❌ 无强制拦截 | AI 可能直接执行高风险操作 |
| ❌ 文档可能不完整 | 按需创建，可能遗漏 |

---

## 四、适用场景

| 场景 | 推荐规范 | 原因 |
|------|----------|------|
| **团队协作** | 规范 A | 流程规范，文档完整，可追溯 |
| **个人开发** | 规范 B | 灵活高效，不需要繁重流程 |
| **复杂项目** | 规范 A | 防止 AI 失控，强制思考 |
| **简单修复** | 规范 B | 快速完成，不走流程 |
| **新手团队** | 规范 A | 规范引导，养成好习惯 |
| **熟练团队** | 规范 B | 信任 AI，快速迭代 |

---

## 五、统一方案（融合最佳实践）

### 5.1 从规范 A 借鉴

| 机制 | 价值 |
|------|------|
| 任务分级 | 不同复杂度不同流程 |
| 中场偏移处理 | 发现问题及时报告 |
| 熔断认错 | AI 违规时主动纠错 |
| 图书馆模式 | CHANGELOG 保持轻量 |

### 5.2 从规范 B 保留

| 机制 | 价值 |
|------|------|
| 协作分层 | L1/L2/L3 灵活控制 |
| 豁免条款 | 小任务不走流程 |
| 精简规则 | 降低认知负担 |

### 5.3 统一优化

| 优化 | 说明 |
|------|------|
| 单文件归档 | spec + plan + task + learnings 合并 |
| 分层 CHANGELOG | 主索引 + 月度详情 |
| 强制 Learnings | 任务完成必须提炼经验 |
| 两层知识库 | 项目级 + 全局级，按需提升 |

---

## 六、决策建议

### 如果你追求"可控性"
→ 采用规范 A 的核心机制，接受效率损失

### 如果你追求"效率"
→ 采用规范 B 的核心机制，接受一定风险

### 如果你想"兼顾"
→ 采用统一方案：
- 日常用规范 B 的协作分层
- 重要任务用规范 A 的三步走
- 归档和知识沉淀统一用优化后的方案

---

*本文档用于团队规范讨论，欢迎头脑风暴*
